<!-- https://squidfunk.github.io/mkdocs-material/customization/#overriding-blocks -->


<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Documentation for the Flexibility Information System">
      
      
      
        <link rel="canonical" href="https://elhub.github.io/flex-information-system/technical/api-design/">
      
      
        <link rel="prev" href="../../resources/technical_resource/">
      
      
        <link rel="next" href="../auth/">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.7">
    
    
      
        <title>API Design - Flexibility Information System Documentation</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.8608ea7d.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../style.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#api-design" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
        <aside class="md-banner">
          <div class="md-banner__inner md-grid md-typeset">
            
              <button class="md-banner__button md-icon" aria-label="Don't show this again">
                
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
              </button>
            
            
    <span>This documentation is work-in-progress and part of the <a href="https://www.euroflex.no/">EuroFlex research project</a>.</span>
    <span>Read more about <a href="/flex-information-system/privacy">privacy and cookies</a></span>

          </div>
          
            <script>var el=document.querySelector("[data-md-component=announce]");if(el){var content=el.querySelector(".md-typeset");__md_hash(content.innerHTML)===__md_get("__announce")&&(el.hidden=!0)}</script>
          
        </aside>
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Flexibility Information System Documentation" class="md-header__button md-logo" aria-label="Flexibility Information System Documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Flexibility Information System Documentation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              API Design
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Flexibility Information System Documentation" class="md-nav__button md-logo" aria-label="Flexibility Information System Documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Flexibility Information System Documentation
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Flexibility Information System
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../changelog/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Changelog
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../privacy/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Privacy and Cookies
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Concepts
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Concepts
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../concepts/end-user/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    End Users
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../concepts/grid-model/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Grid Model
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../concepts/ready-for-market/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Ready for market
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../concepts/suspension/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Suspension
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../concepts/time-series/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Time Series
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Guides
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Guides
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../guides/get-ready-for-market/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Get ready for market
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../guides/getting-started/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Getting Started
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../guides/test-data/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Test Data
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../processes/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Processes
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_6" id="__nav_6_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            Processes
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../processes/controllable-unit-lookup/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    CU Lookup
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../processes/controllable-unit-registration/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    CU Registration
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../processes/controllable-unit-suspension/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    CU Suspension
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../processes/controllable-unit-update/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    CU Update
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../processes/revocation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SP Contract Revocation and Termination
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../processes/service-provider-product-application/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SP Product Application and Qualification
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../processes/service-provider-product-suspension/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SP Product Suspension
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../processes/service-provider-registration-and-approval/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SP Registration and Approval
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../processes/service-provider-switching/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SP Switching Initiated by New SP
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../processes/service-providing-group-grid-suspension/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SPG grid suspension
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../processes/service-providing-group-product-application/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SPG Product Application and Prequalification
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../processes/service-providing-group-registration/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SPG Registration
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../processes/system-operator-product-registration/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SO Product Registration
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../resources/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Resources
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_7" id="__nav_7_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            Resources
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../resources/accounting_point/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Accounting Point
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../resources/accounting_point_balance_responsible_party/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Accounting Point Balance Responsible Party
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../resources/accounting_point_energy_supplier/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Accounting Point Energy Supplier
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../resources/controllable_unit/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Controllable Unit
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../resources/controllable_unit_service_provider/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Controllable Unit Service Provider
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../resources/entity/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Entity
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../resources/entity_client/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Entity Client
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../resources/event/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Event
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../resources/identity/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Identity
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../resources/notice/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Notice
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../resources/notification/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Notification
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../resources/party/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Party
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../resources/party_membership/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Party Membership
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../resources/product_type/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Product Type
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../resources/service_provider_product_application/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Service Provider Product Application
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../resources/service_provider_product_application_comment/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Service Provider Product Application Comment
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../resources/service_provider_product_suspension/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Service Provider Product Suspension
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../resources/service_provider_product_suspension_comment/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Service Provider Product Suspension Comment
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../resources/service_providing_group/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Service Providing Group
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../resources/service_providing_group_grid_prequalification/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Service Providing Group Grid Prequalification
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../resources/service_providing_group_grid_suspension/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Service Providing Group Grid Suspension
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../resources/service_providing_group_membership/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Service Providing Group Membership
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../resources/service_providing_group_product_application/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Service Providing Group Product Application
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../resources/system_operator_product_type/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    System Operator Product Type
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../resources/technical_resource/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Technical Resource
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8" checked>
        
          
          <label class="md-nav__link" for="__nav_8" id="__nav_8_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Technical
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_8">
            <span class="md-nav__icon md-icon"></span>
            Technical
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    API Design
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    API Design
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#design-goals" class="md-nav__link">
    <span class="md-ellipsis">
      Design goals
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#json-over-https" class="md-nav__link">
    <span class="md-ellipsis">
      JSON over HTTPS
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#synchronous-and-stateless" class="md-nav__link">
    <span class="md-ellipsis">
      Synchronous and stateless
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#resource-oriented" class="md-nav__link">
    <span class="md-ellipsis">
      Resource-oriented
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#common-fields" class="md-nav__link">
    <span class="md-ellipsis">
      Common fields
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#history" class="md-nav__link">
    <span class="md-ellipsis">
      History
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#events-and-notifications" class="md-nav__link">
    <span class="md-ellipsis">
      Events and notifications
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#notices" class="md-nav__link">
    <span class="md-ellipsis">
      Notices
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#time-dependent-resources-and-fields" class="md-nav__link">
    <span class="md-ellipsis">
      Time dependent resources and fields
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Time dependent resources and fields">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#reading-a-timeline" class="md-nav__link">
    <span class="md-ellipsis">
      Reading a timeline
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#adding-a-new-or-updating-a-entry-to-the-timeline" class="md-nav__link">
    <span class="md-ellipsis">
      Adding a new or updating a entry to the timeline
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#history-on-time-dependent-resources" class="md-nav__link">
    <span class="md-ellipsis">
      History on time-dependent resources
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#restoring-a-timeline" class="md-nav__link">
    <span class="md-ellipsis">
      Restoring a timeline
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rich-text-fields" class="md-nav__link">
    <span class="md-ellipsis">
      Rich text fields
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#naming-and-casing" class="md-nav__link">
    <span class="md-ellipsis">
      Naming and casing
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#identifiers" class="md-nav__link">
    <span class="md-ellipsis">
      Identifiers
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#discoverability-and-documentation-via-openapi-310" class="md-nav__link">
    <span class="md-ellipsis">
      Discoverability and documentation via OpenAPI 3.1.0
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#note-on-restful-and-hateoas" class="md-nav__link">
    <span class="md-ellipsis">
      Note on RESTful and HATEOAS
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#links" class="md-nav__link">
    <span class="md-ellipsis">
      Links
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../auth/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Auth
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../identifiers/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Identifiers
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../openapi-schemas/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Structure of JSON schemas in the OpenAPI documentation
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../resource-synchronisation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Resource synchronisation from external sources
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../time-series-design/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Time Series Service Design
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../time/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Time
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#design-goals" class="md-nav__link">
    <span class="md-ellipsis">
      Design goals
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#json-over-https" class="md-nav__link">
    <span class="md-ellipsis">
      JSON over HTTPS
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#synchronous-and-stateless" class="md-nav__link">
    <span class="md-ellipsis">
      Synchronous and stateless
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#resource-oriented" class="md-nav__link">
    <span class="md-ellipsis">
      Resource-oriented
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#common-fields" class="md-nav__link">
    <span class="md-ellipsis">
      Common fields
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#history" class="md-nav__link">
    <span class="md-ellipsis">
      History
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#events-and-notifications" class="md-nav__link">
    <span class="md-ellipsis">
      Events and notifications
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#notices" class="md-nav__link">
    <span class="md-ellipsis">
      Notices
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#time-dependent-resources-and-fields" class="md-nav__link">
    <span class="md-ellipsis">
      Time dependent resources and fields
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Time dependent resources and fields">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#reading-a-timeline" class="md-nav__link">
    <span class="md-ellipsis">
      Reading a timeline
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#adding-a-new-or-updating-a-entry-to-the-timeline" class="md-nav__link">
    <span class="md-ellipsis">
      Adding a new or updating a entry to the timeline
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#history-on-time-dependent-resources" class="md-nav__link">
    <span class="md-ellipsis">
      History on time-dependent resources
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#restoring-a-timeline" class="md-nav__link">
    <span class="md-ellipsis">
      Restoring a timeline
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rich-text-fields" class="md-nav__link">
    <span class="md-ellipsis">
      Rich text fields
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#naming-and-casing" class="md-nav__link">
    <span class="md-ellipsis">
      Naming and casing
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#identifiers" class="md-nav__link">
    <span class="md-ellipsis">
      Identifiers
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#discoverability-and-documentation-via-openapi-310" class="md-nav__link">
    <span class="md-ellipsis">
      Discoverability and documentation via OpenAPI 3.1.0
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#note-on-restful-and-hateoas" class="md-nav__link">
    <span class="md-ellipsis">
      Note on RESTful and HATEOAS
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#links" class="md-nav__link">
    <span class="md-ellipsis">
      Links
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="api-design">API Design</h1>
<p>TLDR;</p>
<blockquote>
<p>The Flexibility Information System API is a
<code>Resource-oriented JSON-over-HTTP(s) Data API</code>.</p>
</blockquote>
<h2 id="design-goals">Design goals</h2>
<p>Our design goals are</p>
<ul>
<li>simple and clear</li>
<li>easy to use - APIs are for humans (developers)</li>
<li>simple to maintain</li>
<li>cache friendly (including invalidation)</li>
<li>well-documented</li>
<li>discoverable</li>
<li>facilitates gradual rewrite from postgREST to a custom API implementation</li>
</ul>
<h2 id="json-over-https">JSON over HTTPS</h2>
<p>We use JSON as the data format and HTTPS as the transport protocol. JSON is
the de-facto standard for data exchange on the web. It is light-weight, fairly
easy to read and versatile. It is not as rich as XML and simple as CSV, but
basically all tooling around web APIs support JSON.</p>
<h2 id="synchronous-and-stateless">Synchronous and stateless</h2>
<p>We use a synchronous request-response model. This means that the client sends a
request to the server and waits for a response. The server processes the request
and sends a response back to the client.</p>
<p>This is in contrast to the asynchronous models e.g. in the Elhub API (EMIF)
where the client needs to poll the server for responses separately from the
request.</p>
<h2 id="resource-oriented">Resource-oriented</h2>
<p>We rely on
<a href="https://cloud.google.com/apis/design/resources">resource-oriented design</a> when
designing our api.</p>
<blockquote>
<p>Its core principle is to define named resources that can be manipulated using
a small number of methods. The resources and methods are known as <strong>nouns</strong> and
<strong>verbs</strong> of APIs.</p>
</blockquote>
<p>Nouns are (collections of) resources, and verbs are realized via a combination
of path and HTTP method. We do <strong>not</strong> use Remote Procedure Call (RPC) style paths.
An example can be a <code>controllable_unit</code>.</p>
<table>
<thead>
<tr>
<th>Verb</th>
<th>Path</th>
<th>HTTP Method</th>
<th>RPC Style</th>
</tr>
</thead>
<tbody>
<tr>
<td>Create</td>
<td>/controllable_unit</td>
<td>POST</td>
<td>CreateControllableUnit</td>
</tr>
<tr>
<td>List</td>
<td>/controllable_unit</td>
<td>GET</td>
<td>ListControllableUnits</td>
</tr>
<tr>
<td>Read</td>
<td>/controllable_unit/{id}</td>
<td>GET</td>
<td>ReadControllableUnit</td>
</tr>
<tr>
<td>Update</td>
<td>/controllable_unit/{id}</td>
<td>PATCH</td>
<td>UpdateControllableUnit</td>
</tr>
<tr>
<td>Delete</td>
<td>/controllable_unit/{id}</td>
<td>DELETE</td>
<td>DeleteControllableUnit</td>
</tr>
</tbody>
</table>
<p>We do not use the <code>PUT</code> method simply because we do not need it.
This is in line with the design in the
<a href="https://jsonapi.org/faq/#wheres-put">JSON:API spec</a>.</p>
<p>In case of actual RPC style methods, we use the <code>Call</code> verb.</p>
<p><a href="https://github.com/typicode/json-server">typicode/json-server</a> is very simple
api design that has been used as a reference.</p>
<h2 id="common-fields">Common fields</h2>
<p>We implement a few common fields on all resources. These are</p>
<table>
<thead>
<tr>
<th>Field</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>id</code></td>
<td>bigint</td>
<td>Unique identifier</td>
</tr>
<tr>
<td><code>recorded_at</code></td>
<td>timestamp with time zone</td>
<td>Time the resource was last recorded (created or updated)</td>
</tr>
<tr>
<td><code>recorded_by</code></td>
<td>bigint</td>
<td>Id of the identity that last recorded the resource</td>
</tr>
</tbody>
</table>
<h2 id="history">History</h2>
<p>We provide history as a separate resource on the api. The history resource
provide the same fields as the main resource, but with the addition and
adjustments of a few of the fields.</p>
<table>
<thead>
<tr>
<th>Field</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>id</code></td>
<td>bigint</td>
<td>Unique identifier of the <em>historic record</em></td>
</tr>
<tr>
<td><code>&lt;resource&gt;_id</code></td>
<td>bigint</td>
<td>Id of the resource that this history is for</td>
</tr>
<tr>
<td><code>replaced_at</code></td>
<td>timestamp with time zone</td>
<td>Time the resource was replaced</td>
</tr>
<tr>
<td><code>replaced_by</code></td>
<td>bigint</td>
<td>Id of the identity that replaced the resource</td>
</tr>
</tbody>
</table>
<p>The history records are available via a resource path that appends <code>_history</code> to
the resource name. Example for <code>controllable_unit</code>.</p>
<p>The only allowed action/method is <code>read</code>/<code>GET</code>.</p>
<table>
<thead>
<tr>
<th>Path</th>
<th>Methods</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>/controllable_unit_history</code></td>
<td>GET</td>
<td>List all history records</td>
</tr>
<tr>
<td><code>/controllable_unit_history/{id}</code></td>
<td>GET</td>
<td>Get a specific history record</td>
</tr>
<tr>
<td><code>/controllable_unit_history?controllable_unit_id=eq.{id}</code></td>
<td>GET</td>
<td>List history records for a specific controllable unit</td>
</tr>
<tr>
<td><code>/controllable_unit/{id}/history</code></td>
<td>GET</td>
<td>Redirects (<code>307</code>) to the path shown above.</td>
</tr>
</tbody>
</table>
<h2 id="events-and-notifications">Events and notifications</h2>
<p>Every resource modification in the system leads to an <em>event</em> being recorded.
Events contain data identifying precisely which <em>resource</em> was touched and what
is the <em>nature</em> of the modification done.</p>
<p>The server then turns events into <em>notifications</em> that the user can read and
acknowledge as part of the processes supported by the Flexibility Information
System.</p>
<p><a href="../../resources/event/">Events</a> and <a href="../../resources/notification/">notifications</a>
are reachable in the API as regular resources like the others, <em>i.e.</em>, through
the <code>/event</code> and <code>/notification</code> endpoint families.</p>
<h2 id="notices">Notices</h2>
<p>Strongly enforcing consistency and closely following processes is a <em>hard</em> task
in a system that is optimised for change and where users can make <em>mistakes</em>.</p>
<p>In order to store decently reliable data while still keeping a maintainable
system in the long run, we generally make sure that <em>new</em> data entering the
system are consistent with existing data, but we tolerate some level of
<em>temporary</em> inconsistency or invalidity for some resources. This has several
advantages, such as <em>sparing</em> us the need for advanced <em>rollback</em> mechanisms.</p>
<p>However, even if we do not enforce it as strictly in the database, we consider
that such issues <em>should</em> be fixed eventually. This is the purpose of the
<a href="../../resources/notice/"><em>notice</em></a> resource. It detects inconsistencies or
invalid states in ongoing processes and exposes them through the API for each
user to see what actions on the system are expected from them. This allows
making mistakes but also detecting and fixing them in a decent time, ensuring
<em>eventually strong</em> consistency between the resources in the system in a
flexible way.</p>
<h2 id="time-dependent-resources-and-fields">Time dependent resources and fields</h2>
<p>Some resources or fields are <a href="../time/">time dependent</a>. We model timelines as a
collection of resources with valid time intervals defined by <code>valid_from</code>
(inclusive) and <code>valid_to</code> (exclusive). If a field is time-dependent, we model
it as a separate resource.</p>
<p>In the following sections we will use an example of <code>controllable_unit</code> that has
a <code>service_provider</code> relation that changes over time. This is modelled as a
separate resource <code>controllable_unit_service_provider</code>. In a tabular layout it
looks like this:</p>
<table>
<thead>
<tr>
<th>id</th>
<th>controllable_unit_id</th>
<th>service_provider_id</th>
<th>valid_from</th>
<th>valid_to</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>1</td>
<td>1</td>
<td>2020-07-01</td>
<td>2020-07-06</td>
</tr>
<tr>
<td>2</td>
<td>1</td>
<td>2</td>
<td>2020-07-06</td>
<td>2020-07-11</td>
</tr>
<tr>
<td>3</td>
<td>1</td>
<td>3</td>
<td>2020-07-11</td>
<td>null</td>
</tr>
</tbody>
</table>
<p>The <code>controllable_unit_id</code> identifies a distinct timeline, while a specific
entry is identified by the <code>id</code>.</p>
<p>The following diagram shows how
these three entries are layed out in the timeline.</p>
<p><img alt="time dependent basic diagram" src="../../diagrams/time_dependent_basic.png" /></p>
<h3 id="reading-a-timeline">Reading a timeline</h3>
<p>If you want to see all entries in a timeline you need to query the collection
with a filter that identifies the timeline. For our example, that means a
specific <code>controllable_unit_id</code>, so the operation would look something like
this:</p>
<blockquote>
<p><strong>GET</strong> /controllable_unit_service_provider?controllable_unit_id=eq.1</p>
</blockquote>
<h3 id="adding-a-new-or-updating-a-entry-to-the-timeline">Adding a new or updating a entry to the timeline</h3>
<p>When adding a new entry to the timeline, you basically add a new resource like
with other collections. However, the create operation will also modify or delete
other entries to ensure a non-overlapping timeline.</p>
<p>Say we want to add the following entry to our example timeline:</p>
<div class="highlight"><span class="filename">POST /controllable_unit_service_provider</span><pre><span></span><code><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;controllable_unit_id&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;service_provider_id&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;valid_from&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;2020-07-03T00:00:00.000Z&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;valid_to&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;2020-07-15T00:00:00.000Z&quot;</span>
<span class="p">}</span>
</code></pre></div>
<p>The following diagram shows the timeline before and after adding the entry. The
entries are identified by the id.</p>
<p><img alt="time dependent create diagram" src="../../diagrams/time_dependent_create.png" /></p>
<p>As shown, entry <code>2</code> is removed and entry <code>1</code> and <code>3</code> is modified to fit with the
new resource.</p>
<p>If the new entry is fully overlapped by an existing entry, then the create
will result in a gap in the timeline. As seen in the following diagram, entry
<code>4</code> is modified and limited to the start of the new entry <code>5</code>, leaving a gap
between <code>5</code> and <code>3</code>.</p>
<p><img alt="time_dependent_contains" src="../../diagrams/time_dependent_contains.png" /></p>
<p>Updating a entry is similar to adding a new entry. If the valid time range is
increased, then other entries will be modified or deleted to ensure a
non-overlapping timeline.</p>
<p>If you want to update a resource, like set an end date on the current relation
(where <code>valid_to</code> is null), then you would do a update operation on that specific
resource.</p>
<div class="highlight"><span class="filename">PATCH /controllable_unit_service_provider/3</span><pre><span></span><code><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;valid_to&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;2020-08-15T00:00:00.000Z&quot;</span>
<span class="p">}</span>
</code></pre></div>
<div class="admonition note">
<p class="admonition-title">Gaps are allowed</p>
<p>The update mechanisms does not care about gaps in the timeline, they are
generally allowed. This means that the logic does not adjust the timeline
(i.e. update other entries) if a entry is deleted or its valid time is
decreased.</p>
</div>
<h3 id="history-on-time-dependent-resources">History on time-dependent resources</h3>
<p>We provide history on time-dependent resources as well. This follows the same
pattern as the <a href="#history">regular history</a>. Time dependent resources with
history provides <a href="../time/#bi-temporal-data">bi-temporal</a> data.</p>
<h3 id="restoring-a-timeline">Restoring a timeline</h3>
<p>Restoring a timeline is done with regular updates. You would need to do a
<code>PATCH</code> operations on the specific entries. The typical workflow would be:</p>
<ol>
<li>List the history of the timeline (possibly filtered by record time)</li>
<li>Find the history entries that should to be restored</li>
<li>Do a <code>PATCH</code> operation on the specific entries with the old data to restore it</li>
</ol>
<p>Deleted entries are only soft-deleted in the system by setting <code>valid_from</code> and
<code>valid_to</code> as null. These resources also accept <code>PATCH</code> operations. A <code>PATCH</code> to
restore a deleted resource requires that the <code>valid_from</code> is set to a non-null
value.</p>
<div class="admonition note">
<p class="admonition-title">No revert or rollback operations</p>
<p>We do <strong>not</strong> provide a revert operation that restores a timeline to a specific
point in time. Restore must be done on the individual entries in sequence.</p>
<p>We do <strong>not</strong> provide a rollback operation to undo all the changes that
occurred due to a specific <code>PATCH</code> or <code>POST</code>. Rollback operations are hard
to get right in situations where there could be multiple changes to the
timeline since the point in time you want to rollback to.</p>
</div>
<h2 id="rich-text-fields">Rich text fields</h2>
<p>Some text fields actually support <em>rich text</em> content. For simplicity, we chose
HTML as the format of rich text fields, as it is a very common format readily
available in all web browsers, which are likely to be the host of the frontend
environments that will interact with our API.</p>
<p>In such cases, where data stored in a system must be <em>interpreted</em> in order to
be displayed, this data should always go through a <em>sanitisation</em> step before
being used. This sanitisation can happen one or several times, before storing
the data or after retrieving it. For now, rich text fields are a test feature,
so we choose not to validate their content on the server side. It is therefore
left to the responsibility of our users to sanitise the content of rich text
fields before exploiting it. Note that the default user interface we offer as
part of our test platform use components performing the expected sanitisation.</p>
<h2 id="naming-and-casing">Naming and casing</h2>
<p>Singular vs plural is basically a matter of taste. We just had to pick one. We
use singular names on all resources. This is a design choice to make the
API more consistent with the data model in the database, where the
<a href="https://stackoverflow.com/a/5841297">singular names are nice</a>.</p>
<p>Another way we make the API consistent with the database is by using
<code>snake_case</code> for resource/collection, field names and enumerations. This allows
us to have the same name across all layers.</p>
<h2 id="identifiers">Identifiers</h2>
<p>We use <code>id</code> as the primary <a href="../identifiers/">identifier</a> for all resources. The
<code>id</code> is a unique integer generated by a sequence in the system. It is a
<a href="https://en.wikipedia.org/wiki/Surrogate_key">surrogate key</a>.</p>
<p>Where relevant we also store natural keys or other identifiers on the
resources. If so, these are usually stored in a field name <code>business_id</code>. If the
resources support multiple types of identifiers, we include a <code>business_id_type</code>
field as part of the identifier.</p>
<p>Finding a resource by this identifier can be done by filtering on the
<code>business_id</code> field. E.g. <code>GET /controllable_unit?business_id=eq.123456</code>.</p>
<h2 id="discoverability-and-documentation-via-openapi-310">Discoverability and documentation via OpenAPI 3.1.0</h2>
<p>Provide discoverability via OpeanAPI 3.1.0 document and generated documentation.
We are using 3.1 over 3.0 due to the full support of JSON Schema.</p>
<p>We are following a spec-first approach where we define the API in an OpenAPI
document first and implement later. This allows us to switch implementations
while having a stable api/document. It comes at the cost of having to maintain
the document manually. This maintenance is however eased through the use of
templating to avoid repeating ourselves and making mistakes. Templating also
normalises the API by making sure similar operations lead to similar endpoints.</p>
<h2 id="note-on-restful-and-hateoas">Note on RESTful and HATEOAS</h2>
<p>We cannot talk about API design without talking about RESTful APIs and HATEOAS.</p>
<p><strong>REST</strong> stands for <strong>RE</strong>presentational <strong>S</strong>tate <strong>T</strong>ransfer. RESTful APIs
are APIs that adhere to the REST architectural constraints. First coined by Roy
Fielding in his doctoral dissertation, REST is a set of constraints that, when
followed, enable a loose coupling between clients and servers. This loose
coupling is achieved by having the server send hypermedia links to the client,
which the client can then use to navigate the API. This is known as <strong>HATEOAS</strong>,
or <strong>H</strong>ypermedia <strong>A</strong>s <strong>T</strong>he <strong>E</strong>ngine <strong>O</strong>f <strong>A</strong>pplication <strong>S</strong>tate.</p>
<p>Implemeting a RESTful API is not easy, and most APIs that claim to be RESTful
are not. For some good reading on this topic, check out the following links:</p>
<ul>
<li><a href="https://htmx.org/essays/hypermedia-apis-vs-data-apis/">Hypermedia APIs vs Data APIs</a></li>
<li><a href="https://roy.gbiv.com/untangled/2008/rest-apis-must-be-hypertext-driven">REST APIs must be hypertext-driven</a></li>
</ul>
<p>We believe that RESTful APIs are really powerful, but complex. The true value of
a RESTful API is
<a href="https://twitter.com/fielding/status/376835835670167552">evolveability</a>. On the
<a href="https://martinfowler.com/articles/richardsonMaturityModel.html">Richardson Maturity Model</a>
that evolveability is only achieved at level 3, with a true Hypermedia API. For
that to work, we put a lot of constraints on clients. As an example, our clients
would not be able to rely on fixed resource names or hierarchies.</p>
<p>We are aiming for level 2 on the Richardson Maturity Model. We are ok with a
higher degree of coupling between clients and servers.</p>
<p>But we try not to call our API REST or RESTful since the terms have very different
meanings depending on who you ask. We are calling our API style a
<code>Data API</code>.</p>
<h2 id="links">Links</h2>
<p>One of the major benefits of the REST architectural style is that links are very
explicit by being part of the response. Our API does not return links, but
we provides information on how to navigate the API in the
documentation. The
<a href="https://github.com/OAI/OpenAPI-Specification/issues/1327">OpenAPI spec is a bit limited</a>
in this regard. The
<a href="https://spec.openapis.org/oas/v3.1.0#link-object">Link Object</a> also doesn't
display well (or at all) in the generated docs tools.</p>
<p>We provide a <code>links</code> object in the  <code>20*</code> response to <code>Read</code> requests, but omit
it in <code>List</code>, <code>Create</code> and <code>Update</code> requests. This is just to limit the amount
of toil/busywork related to maintaining the OpenAPI document.</p>
<p>We also document the link as part of the textual field description in the OpenAPI
schemas.</p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.indexes", "announce.dismiss"], "search": "../../assets/javascripts/workers/search.f8cc74c7.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.c8b220af.min.js"></script>
      
    
  </body>
</html>